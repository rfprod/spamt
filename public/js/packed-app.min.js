"use strict";var __decorate=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),http_1=require("@angular/http"),common_1=require("@angular/common"),router_deprecated_1=require("@angular/router-deprecated"),app_routes_1=require("./app.routes"),app_nav_component_1=require("./components/app-nav.component"),app_info_component_1=require("./components/app-info.component"),dashboard_intro_component_1=require("./components/dashboard-intro.component"),dashboard_details_component_1=require("./components/dashboard-details.component"),event_emitter_service_1=require("./services/event-emitter.service"),AppComponent=function(){function e(e,t){this.el=e,this.emitter=t,console.log("this.el.nativeElement",this.el.nativeElement)}return e.prototype.startSpinner=function(){console.log("spinner start")},e.prototype.stopSpinner=function(){console.log("spinner stop")},e.prototype.ngOnInit=function(){var e=this;console.log("ngOnInit: AppComponent initialized"),$("#init-spinner").remove(),this.subscription=this.emitter.getEmitter().subscribe(function(t){console.log("app consuming event:",t),"start spinner"===t.sys&&(console.log("starting spinner"),e.startSpinner()),"stop spinner"===t.sys&&(console.log("stopping spinner"),e.stopSpinner())})},e.prototype.ngOnDestroy=function(){console.log("ngOnDestroy: AppComponent destroyed"),this.subscription.unsubscribe()},e=__decorate([core_1.Component({selector:"spamt",template:"\n\t\t<app-nav></app-nav>\n\t\t<router-outlet></router-outlet>\n\t\t<app-info></app-info>\n\t",providers:[router_deprecated_1.ROUTER_PROVIDERS,core_1.provide(common_1.LocationStrategy,{useClass:common_1.HashLocationStrategy}),event_emitter_service_1.EventEmitterService,http_1.HTTP_PROVIDERS,http_1.ConnectionBackend],directives:[app_nav_component_1.AppNavComponent,app_info_component_1.AppInfoComponent,dashboard_intro_component_1.DashboardIntroComponent,dashboard_details_component_1.DashboardDetailsComponent,router_deprecated_1.ROUTER_DIRECTIVES]}),router_deprecated_1.RouteConfig(app_routes_1.APP_ROUTES),__metadata("design:paramtypes",[core_1.ElementRef,event_emitter_service_1.EventEmitterService])],e)}();exports.AppComponent=AppComponent;var core_1=require("@angular/core"),platform_browser_dynamic_1=require("@angular/platform-browser-dynamic"),app_component_1=require("./app.component");core_1.enableProdMode(),platform_browser_dynamic_1.bootstrap(app_component_1.AppComponent);var dashboard_intro_component_1=require("./components/dashboard-intro.component"),dashboard_details_component_1=require("./components/dashboard-details.component");exports.APP_ROUTES=[{path:"/",redirectTo:["Intro"]},{path:"/intro",name:"Intro",component:dashboard_intro_component_1.DashboardIntroComponent,useAsDefault:!0},{path:"/data",name:"Data",component:dashboard_details_component_1.DashboardDetailsComponent,useAsDefault:!1}];var __decorate=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),event_emitter_service_1=require("../services/event-emitter.service"),AppInfoComponent=function(){function e(e){this.emitter=e,this.hideInfo=!0,this.badges=[{title:"Node.js - an open-source, cross-platform runtime environment for developing server-side Web applications.",link:"https://en.wikipedia.org/wiki/Node.js",img:"/public/img/Node.js_logo.svg"},{title:"MongoDB - a free and open-source cross-platform document-oriented database.",link:"https://en.wikipedia.org/wiki/MongoDB",img:"/public/img/MongoDB_logo.svg"},{title:"AngularJS - an open-source web application framework mainly maintained by Google and by a community of individuals and corporations.",link:"https://en.wikipedia.org/wiki/AngularJS",img:"/public/img/AngularJS_logo.svg"},{title:"Soundcloud - a global online audio distribution platform based in Berlin, Germany, that enables its users to upload, record, promote, and share their originally-created sounds.",link:"https://en.wikipedia.org/wiki/SoundCloud",img:"/public/img/SoundCloud_logo.svg"}]}return e.prototype.ngOnInit=function(){var e=this;console.log("ngOnInit: AppInfoComponent initialized"),this.subscription=this.emitter.getEmitter().subscribe(function(t){console.log("app-info consuming event:",t),"hide"===t.appInfo&&(e.hideInfo=!0),"show"===t.appInfo&&(e.hideInfo=!1)})},e.prototype.ngOnDestroy=function(){console.log("ngOnDestroy: AppInfoComponent destroyed"),this.subscription.unsubscribe()},e=__decorate([core_1.Component({selector:"app-info",template:'\n\t\t<a class="flex-item" [hidden]="hideInfo" *ngFor="let badge of badges" href="{{badge.link}}" data-toggle="tooltip" target=_blank title="{{badge.title}}">\n\t\t\t<img src="{{badge.img}}"/>\n\t\t</a>\n\t',providers:[]}),__metadata("design:paramtypes",[event_emitter_service_1.EventEmitterService])],e)}();exports.AppInfoComponent=AppInfoComponent;var __decorate=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),common_1=require("@angular/common"),router_deprecated_1=require("@angular/router-deprecated"),event_emitter_service_1=require("../services/event-emitter.service"),AppNavComponent=function(){function e(e){this.emitter=e,this.navButtonsState=[!1,!1,!1]}return e.prototype.switchNavButtons=function(e,t){var r,o;console.log("switchNavButtons:",e),r=t?"i"===e.target.localName?e.target.parentElement.href:e.target.href:e.route,o=r.indexOf("/intro")!==-1?1:r.indexOf("/data")!==-1?2:0;for(var n in this.navButtonsState)n===o?this.navButtonsState[n]=!0:this.navButtonsState[n]=!1},e.prototype.stopWS=function(){console.log("close websocket event emitted"),this.emitter.emitEvent({sys:"close websocket"})},e.prototype.ngOnInit=function(){var e=this;console.log("ngOnInit: AppNavComponent initialized"),this.subscription=this.emitter.getEmitter().subscribe(function(t){console.log("/app-nav consuming event:",t),"undefined"!=typeof t.route&&(console.log("route is defined"),e.switchNavButtons(t,!1),e.subscription.unsubscribe())})},e.prototype.ngOnDestroy=function(){console.log("ngOnDestroy: AppNavComponent destroyed")},e=__decorate([core_1.Component({selector:"app-nav",templateUrl:"/public/app/views/dashboard-nav.html",providers:[],directives:[router_deprecated_1.ROUTER_DIRECTIVES,common_1.NgClass]}),__metadata("design:paramtypes",[event_emitter_service_1.EventEmitterService])],e)}();exports.AppNavComponent=AppNavComponent;var __decorate=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),common_1=require("@angular/common"),event_emitter_service_1=require("../services/event-emitter.service"),user_details_service_1=require("../services/user-details.service"),DashboardDetailsComponent=function(){function e(e,t,r){this.el=e,this.emitter=t,this.UserDetailsService=r,this.publicData=[{users:[]},{labels:[]}],this.labelDetails=[],this.orderProp="timestamp",console.log("this.el.nativeElement:",this.el.nativeElement)}return e.prototype.getUserDetails=function(e,t){var r=this;this.UserDetailsService.getUserDetails().subscribe(function(e){return r.labelDetails=e},function(e){return r.errorMessage=e},function(){console.log("getUserDetails done"),t(r.labelDetails)})},e.prototype.showLabelDetailsPreview=function(e){var t=this;console.log("mouse enter");var r=e.target.parentElement.querySelectorAll("span");""===r[1].innerHTML?(this.emitSpinnerStartEvent(),this.getUserDetails(e.target.id,function(e){var o=e[0];console.log(o),r[1].innerHTML='<i class="fa fa-music" aria-hidden="true"></i> '+o.track_count,r[2].innerHTML='<i class="fa fa-list" aria-hidden="true"></i> '+o.playlist_count,r[3].innerHTML='<i class="fa fa-star" aria-hidden="true"></i> '+o.public_favorites_count,r[4].innerHTML='<i class="fa fa-users" aria-hidden="true"></i> '+o.followers_count,t.emitSpinnerStopEvent(),setTimeout(function(){r[0].style.display="none"},1e3)})):r[0].style.display="flex"},e.prototype.hideLabelDetailsPreview=function(e){console.log("mouse leave");var t=e.target.parentElement.querySelectorAll("span");""!==t[1].innerHTML&&(t[0].style.display="none")},Object.defineProperty(e.prototype,"labelSearchQuery",{get:function(){return this.labelSearchValue},set:function(e){this.emitLabelSearchValueChangeEvent(e)},enumerable:!0,configurable:!0}),e.prototype.emitLabelSearchValueChangeEvent=function(e){console.log("labelSearchValue changed to:",e),this.emitter.emitEvent({search:e})},Object.defineProperty(e.prototype,"sortLabelsByCriterion",{get:function(){return this.orderProp},set:function(e){this.emitOrderPropChangeEvent(e)},enumerable:!0,configurable:!0}),e.prototype.emitOrderPropChangeEvent=function(e){console.log("orderProp changed to:",e),this.emitter.emitEvent({sort:e})},e.prototype.emitSpinnerStartEvent=function(){console.log("root spinner start event emitted"),this.emitter.emitEvent({sys:"start spinner"})},e.prototype.emitSpinnerStopEvent=function(){console.log("root spinner stop event emitted"),this.emitter.emitEvent({sys:"stop spinner"})},e.prototype.ngOnInit=function(){var e=this;console.log("ngOnInit: DashboardDetailsComponent initialized"),this.emitSpinnerStartEvent(),this.emitter.emitEvent({route:"/data"}),this.emitter.emitEvent({appInfo:"hide"}),this.subscription=this.emitter.getEmitter().subscribe(function(t){if(console.log("/data consuming event:",JSON.stringify(t)),t.search||""===t.search){console.log("searching:",t.search);for(var r=e.el.nativeElement.querySelector("ul.labels").querySelectorAll("#label-username"),o=0,n=r;o<n.length;o++){var i=n[o];i.innerHTML.toLowerCase().indexOf(t.search.toLowerCase())!==-1?i.parentElement.parentElement.style.display="block":i.parentElement.parentElement.style.display="none"}}t.sort&&(console.log("sorting by:",t.sort),"timestamp"===t.sort&&e.publicData[1].labels.sort(function(e,t){return t.timestamp-e.timestamp}),"username"===t.sort&&e.publicData[1].labels.sort(function(e,t){return e.permalink<t.permalink?-1:e.permalink>t.permalink?1:0}))})},e.prototype.ngOnDestroy=function(){console.log("ngOnDestroy: DashboardDetailsComponent destroyed"),this.subscription.unsubscribe(),this.emitSpinnerStopEvent()},e=__decorate([core_1.Component({selector:"dashboard-details",templateUrl:"/public/app/views/dashboard-details.html",providers:[user_details_service_1.UserDetailsService],directives:[common_1.NgFor]}),__metadata("design:paramtypes",[core_1.ElementRef,event_emitter_service_1.EventEmitterService,user_details_service_1.UserDetailsService])],e)}();exports.DashboardDetailsComponent=DashboardDetailsComponent;var __decorate=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),ng2_nvd3_1=require("ng2-nvd3"),angular2_websocket_1=require("angular2-websocket/angular2-websocket"),event_emitter_service_1=require("../services/event-emitter.service"),server_static_data_service_1=require("../services/server-static-data.service"),public_data_service_1=require("../services/public-data.service"),DashboardIntroComponent=function(){function e(e,t,r,o){this.el=e,this.emitter=t,this.serverStaticDataService=r,this.publicDataService=o,this.title="SPAMT",this.description="Social Profile Analysis and Management Tool",this.wsUrl="ws://localhost:8080/app-diag/dynamic",this.chartOptions={chart:{type:"pieChart",height:450,donut:!0,x:function(e){return e.key},y:function(e){return e.y},showLabels:!0,pie:{startAngle:function(e){return e.startAngle/2-Math.PI/2},endAngle:function(e){return e.endAngle/2-Math.PI/2}},duration:1e3,legend:{margin:{top:5,right:140,bottom:5,left:0}}}},this.appUsageData=[{key:"Default",y:1},{key:"Default",y:1},{key:"Default",y:1},{key:"Default",y:1},{key:"Default",y:1}],this.serverData={"static":[],dynamic:[]},this.ws=new angular2_websocket_1.$WebSocket(this.wsUrl),this.showModal=!1,console.log("this.el.nativeElement:",this.el.nativeElement)}return e.prototype.getServerStaticData=function(e){var t=this;this.serverStaticDataService.getData().subscribe(function(e){return t.serverData["static"]=e},function(e){return t.errorMessage=e},function(){console.log("getServerStaticData done, data:",t.serverData["static"]),e(t)})},e.prototype.getPublicData=function(e){var t=this;this.publicDataService.getData().subscribe(function(e){return t.appUsageData=e},function(e){return t.errorMessage=e},function(){console.log("getPublicData done, data:",t.appUsageData),e(t)})},e.prototype.emitSpinnerStartEvent=function(){console.log("root spinner start event emitted"),this.emitter.emitEvent({sys:"start spinner"})},e.prototype.emitSpinnerStopEvent=function(){console.log("root spinner stop event emitted"),this.emitter.emitEvent({sys:"stop spinner"})},e.prototype.toggleModal=function(){this.showModal=!this.showModal},e.prototype.ngOnInit=function(){var e=this;console.log("ngOnInit: DashboardIntroComponent initialized"),this.emitSpinnerStartEvent(),this.emitter.emitEvent({route:"/intro"}),this.emitter.emitEvent({appInfo:"show"}),this.ws.send(JSON.stringify({action:"get"})),this.ws.onOpen(function(t){console.log("ws connection opened, state:",e.ws.getReadyState()," | event:",t)}),this.ws.onMessage(function(t){console.log("ws incoming message"),console.log(t),e.serverData.dynamic=[];var r=JSON.parse(t.data);for(var o in r)r[o]&&e.serverData.dynamic.push(r[o]);console.log("this.serverData['dynamic']:",e.serverData.dynamic)},{}),this.ws.onError(function(t){console.log("ws connection error, state:",e.ws.getReadyState()),console.log(t),e.ws.close(!0)}),this.ws.onClose(function(t){console.log("ws connection closed, state:",e.ws.getReadyState()),console.log(t)}),this.subscription=this.emitter.getEmitter().subscribe(function(t){console.log("/intro consuming event:",t),"close websocket"===t.sys&&(console.log("closing webcosket"),e.subscription.unsubscribe(),e.ws.close(!0))}),this.getServerStaticData(function(e){e.emitSpinnerStopEvent()}),this.getPublicData(function(e){e.emitSpinnerStopEvent()})},e.prototype.ngOnDestroy=function(){console.log("ngOnDestroy: DashboardIntroComponent destroyed"),this.subscription.unsubscribe(),this.ws.close(!0)},e=__decorate([core_1.Component({selector:"dashboard-intro",templateUrl:"/public/app/views/dashboard-intro.html",providers:[server_static_data_service_1.ServerStaticDataService,public_data_service_1.PublicDataService],directives:[ng2_nvd3_1.nvD3]}),__metadata("design:paramtypes",[core_1.ElementRef,event_emitter_service_1.EventEmitterService,server_static_data_service_1.ServerStaticDataService,public_data_service_1.PublicDataService])],e)}();exports.DashboardIntroComponent=DashboardIntroComponent;var core_1=require("@angular/core"),EventEmitterService=function(){function e(){this.emitter=new core_1.EventEmitter}return e.prototype.emitEvent=function(e){this.emitter.emit(e)},e.prototype.getEmitter=function(){return this.emitter},e}();exports.EventEmitterService=EventEmitterService;var __decorate=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),http_1=require("@angular/http"),Observable_1=require("rxjs/Observable");require("rxjs/Rx");var PublicDataService=function(){function e(e){this.http=e,this.appDataUrl="http://localhost:8080/dummy"}return e.prototype.extractData=function(e){var t=e.json();return t||{}},e.prototype.handleError=function(e){var t=e.message?e.message:e.status?"$[error.status] - $[error.statusText]":"Server error";return console.log(t),Observable_1.Observable["throw"](t)},e.prototype.getData=function(){return this.http.get(this.appDataUrl).map(this.extractData)["catch"](this.handleError)},e=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[http_1.Http])],e)}();exports.PublicDataService=PublicDataService;var __decorate=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),http_1=require("@angular/http"),Observable_1=require("rxjs/Observable");require("rxjs/Rx");var ServerStaticDataService=function(){function e(e){this.http=e,this.appDataUrl="http://localhost:8080/app-diag/static"}return e.prototype.extractData=function(e){var t=e.json();return t||{}},e.prototype.handleError=function(e){var t=e.message?e.message:e.status?"$[error.status] - $[error.statusText]":"Server error";return console.log(t),Observable_1.Observable["throw"](t)},e.prototype.getData=function(){return this.http.get(this.appDataUrl).map(this.extractData)["catch"](this.handleError)},e=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[http_1.Http])],e)}();exports.ServerStaticDataService=ServerStaticDataService;var __decorate=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),http_1=require("@angular/http"),Observable_1=require("rxjs/Observable");require("rxjs/Rx");var UserDetailsService=function(){function e(e){this.http=e,this.appDataUrl="http://localhost:8080/dummy"}return e.prototype.extractData=function(e){var t=e.json();return t||{}},e.prototype.handleError=function(e){var t=e.message?e.message:e.status?"$[error.status] - $[error.statusText]":"Server error";return console.log(t),Observable_1.Observable["throw"](t)},e.prototype.getUserDetails=function(){return this.http.get(this.appDataUrl).map(this.extractData)["catch"](this.handleError)},e=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[http_1.Http])],e)}();exports.UserDetailsService=UserDetailsService;